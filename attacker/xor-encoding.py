import os

def xor_encode_file(input_file_path, output_file_path, key):
    with open(input_file_path, 'rb') as file:
        original_data = file.read()
    
    encoded_data = bytearray(len(original_data))
    
    for i in range(len(original_data)):
        encoded_data[i] = original_data[i] ^ key
    
    with open(output_file_path, 'wb') as file:
        file.write(encoded_data)

def xor_encode_directory(input_dir, output_dir, key):
    # Ensure output directory exists
    if not os.path.exists(output_dir):
        os.makedirs(output_dir)
    
    # Process each file in the input directory
    for filename in os.listdir(input_dir):
        input_file_path = os.path.join(input_dir, filename)
        output_file_path = os.path.join(output_dir, filename)
        
        # Check if it's a file and not a directory
        if os.path.isfile(input_file_path):
            xor_encode_file(input_file_path, output_file_path, key)

key = 0x73

# Example usage
input_directory = "C:\\Users\\sonjo\\dev-env\\dropped-folder"
output_directory = "C:\\Users\\sonjo\\dev-env\\dropper-xor-folder"

xor_encode_directory(input_directory, output_directory, key)
