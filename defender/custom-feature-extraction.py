import numpy as np
from customfeatures import PEFeatureExtractor

extractor = PEFeatureExtractor(feature_version=2)

features = np.empty((0, 638))
pe_file_paths = ["/Users/skpaul/mac-tamu/malware-project/malware-sample/benign-folder/7z2401-x64.exe", 
                 "/Users/skpaul/mac-tamu/malware-project/malware-sample/malware-folder/742d5abe0d2712d207d02d22982ec5d84e3ac77e07e70c6e6c6720a147a16d89.exe",
                 "/Users/skpaul/mac-tamu/malware-project/malware-sample/mew_ADExplorer.exe",
                 "/Users/skpaul/mac-tamu/malware-project/malware-sample/nspack_Kalmuri.exe"]

for pe_file_path in pe_file_paths:
    putty_data = open(pe_file_path, "rb").read()
    #features = extractor.raw_features(putty_data)
    features_for_one_pe_file = np.array(extractor.feature_vector(putty_data), dtype=np.float32)
    print(features_for_one_pe_file.shape)
    #features = np.transpose(features_for_one_pe_file)
    #features = features[:-4]
    features = np.vstack((features, features_for_one_pe_file))
    print(features.shape)

    unknownSectionsCounter, packerSectionNameCounter = extractor.getSectionNameInfo(putty_data)
    print(unknownSectionsCounter)
    print(packerSectionNameCounter)
    
print(features.shape)