import numpy as np
#from customfeatures import PEFeatureExtractor
from features import PEFeatureExtractor

extractor = PEFeatureExtractor(feature_version=2)

features = np.empty((0,2381))
pe_file_paths = ["/Users/skpaul/mac-tamu/malware-project/malware-sample/benign-folder/7z2401-x64.exe", 
                 "/Users/skpaul/mac-tamu/malware-project/malware-sample/malware-folder/742d5abe0d2712d207d02d22982ec5d84e3ac77e07e70c6e6c6720a147a16d89.exe",
                 "/Users/skpaul/mac-tamu/malware-project/malware-sample/packed-folder/mew_ADExplorer.exe",
                 "/Users/skpaul/mac-tamu/malware-project/malware-sample/packed-folder/nspack_Kalmuri.exe"]

for pe_file_path in pe_file_paths:
    putty_data = open(pe_file_path, "rb").read()
    #features = extractor.raw_features(putty_data)
    raw_features = extractor.raw_features(putty_data)
    print(len(raw_features))
    features_for_one_pe_file = np.array(extractor.feature_vector(putty_data), dtype=np.float64)
    print(features_for_one_pe_file.shape)
    features = np.vstack((features, features_for_one_pe_file))
    print(features.shape)
    
print(features.shape)